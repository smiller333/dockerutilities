# Web Server Package

This package provides a web server for viewing Docker image analysis results generated by the `dockerutils analyze` command.

## Features

- **Static Web Interface**: Serves a modern, responsive web UI for browsing image summaries
- **REST API**: Provides JSON API endpoints for accessing image data programmatically
- **Auto-discovery**: Automatically finds and serves analysis results from the `tmp/` directory
- **Graceful Shutdown**: Handles SIGINT and SIGTERM for clean server shutdown

## API Endpoints

### GET /api/health
Returns server health status.

**Response:**
```json
{
  "status": "healthy",
  "timestamp": "2025-06-30T12:00:00Z",
  "version": "1.0.0"
}
```

### GET /api/summaries
Returns a list of all available image summaries.

**Response:**
```json
[
  {
    "id": "7aab056cecc6",
    "image_tag": "alpine:3.20",
    "image_id": "sha256:7aab056cecc6...",
    "analyzed_at": "2025-06-30T12:00:00Z",
    "architecture": "amd64",
    "os": "linux",
    "layer_count": 3,
    "image_size": 7738912,
    "file_path": "/path/to/summary.7aab056cecc6.json"
  }
]
```

### GET /api/summaries/{id}
Returns the full analysis data for a specific image summary.

**Response:**
Full JSON content of the analysis file, including filesystem analysis, layer information, etc.

## Configuration

The server is configured via the `Config` struct:

```go
type Config struct {
    Host    string // Host/IP address to bind to (default: "localhost")
    Port    string // Port number to listen on (default: "8080")
    WebRoot string // Custom web root directory (optional, defaults to "web/")
}
```

## Usage

The web server is typically started via the `image-viewer` command:

```bash
dockerutils image-viewer --port 8080 --host localhost
```

## Web Interface

The web interface provides:

- **Summary Cards**: Visual cards showing key information about each analyzed image
- **Detailed View**: Modal popup with full JSON analysis data
- **Responsive Design**: Works on desktop and mobile devices
- **Auto-refresh**: Ability to refresh data without restarting the server

## File Discovery

The server automatically scans the `tmp/` directory (relative to the current working directory) for files matching the pattern `summary.*.json`. These files are generated by the `dockerutils analyze` command.

## Security Considerations

- The server binds to localhost by default for security
- No authentication is implemented (intended for local development use)
- File access is restricted to the configured web root and tmp directories
- Path traversal protection is implemented for tar extraction operations
